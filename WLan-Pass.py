import subprocess
import re


# List of Wlan interfaces connected before/frequently 
cmd = subprocess.Popen('netsh wlan show profiles', shell=True, stdout=subprocess.PIPE)
ssids = [];
for line in cmd.stdout:
	line = line.strip()
	searchObj = re.search( ': ', line, re.M|re.I)
	if searchObj:
		ssid=line.split(':')[1]
		ssids.append(ssid);
	

for key in ssids:
	cmd = subprocess.Popen('netsh wlan show profiles name='+key+' key=clear', shell=True, stdout=subprocess.PIPE)
	for lin in cmd.stdout:
		searchobject = re.search('Key Content', lin ,re.M|re.I)
		if searchobject:
			keys = lin.split(':')[1]
			print key +" -> "+ keys
