#!/usr/bin/env ruby
require 'net/http'
require 'uri'

class OpenRedirection_Fuzz

 def initialize()
 puts "Enter the text file"
 @file = gets.chomp
 end

 def read_file
 File.readlines(@file).each do |line |
    @line = line.chomp.to_s
  redir(@line)
 end
 end

 def redir(url)
 payload = "//google.com/%2F.."
 url = url + payload
 url_effective = `curl -Ls -w %{url_effective} -o /dev/null #{url}`
 url_effective = url_effective.chomp.to_s
 if url_effective.include ? "https://google.com/"
 puts "#{url} - Vulnerable!"
 else
  end
 end
end

Red = OpenRedirection_Fuzz.new()
Red.read_file
